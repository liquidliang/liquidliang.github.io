{"version":3,"sources":["webpack:///webpack/bootstrap b4cbac4fbdcfff6eb339","webpack:///./source/src/index.js","webpack:///./source/src/polyfill/index.js","webpack:///./source/src/polyfill/array.js","webpack:///./source/src/polyfill/set.js","webpack:///./source/src/polyfill/object.js","webpack:///./source/src/helper/common_event.js","webpack:///./source/src/common/util/index.js","webpack:///./source/src/common/util/event.js","webpack:///./source/src/common/util/load.js","webpack:///./source/src/common/util/dom.js","webpack:///./source/src/common/util/iterator.js","webpack:///./source/src/model/article.js","webpack:///./source/src/helper/search.js","webpack:///./source/src/model/read_history.js","webpack:///./source/src/model/config.js","webpack:///./source/src/model/read_favor.js","webpack:///./source/src/helper/sw_post_message.js","webpack:///./source/src/helper/ability.js","webpack:///./source/src/helper/promise_ajax.js","webpack:///./source/src/helper/load_lib.js","webpack:///./source/src/card/common/navigator.js","webpack:///./source/src/page/list.js","webpack:///./source/src/card/common/footer.js","webpack:///./source/src/card/common/main_container.js","webpack:///./source/src/helper/init_option.js","webpack:///./source/src/card/blog/pannel.js","webpack:///./source/src/card/blog/pannel_list.js","webpack:///./source/src/helper/recommend.js","webpack:///./source/src/card/blog/article_list.js","webpack:///./source/src/page/book.js","webpack:///./source/src/card/common/slidebar_container.js","webpack:///./source/src/page/content.js","webpack:///./source/src/card/blog/content.js","webpack:///./source/src/page/blog.js","webpack:///./source/src/page/search.js","webpack:///./source/src/card/blog/pull_article.js","webpack:///./source/src/page/setting.js","webpack:///./source/src/helper/notification.js","webpack:///./source/src/helper/auto_cache.js"],"names":["require","m_article","m_config","c_header","c_pageList","c_pageBook","c_pageContent","c_pageBlog","c_pageSearch","c_setting","viewHeader","$","append","getConfig","then","initArticle","reset","BCD","app","setTitle","str","navLis","find","removeClass","each","i","domLi","url","attr","location","hash","indexOf","addClass","document","title","initPage","key","next","page","path","decodeURIComponent","hasBook","hasCatalog","hasArticle","replaceHash","getIndex","Array","from","arr","arr2","length","window","Set","list","call","add","prototype","Object","create","data","push","delete","pos","splice","has","size","clear","set","pop","values","assign","extend","m_util","onClick","name","fun","addEvent","ele","option","on","e","stopBubble","go","back","history","module","exports","m_event","getTime","date","Date","now","diff","Math","round","getDate","getFullYear","time","formatDate","leftFillString","num","substr","getRandomName","random","toString","replace","_date","performance","stopBubbleEx","load","dom","iterator","stopPropagation","preventDefault","scriptDict","LOAD_CALLBACK","callback","console","log","arguments","promiseLoad","Promise","resolve","head","getElementsByTagName","loadList","is","s","map","src","abs","forEach","loadDom","test","createElement","type","charset","async","rel","href","onload","every","appendChild","getWindowHeight","innerHeight","clientHeight","getWindowWidth","innerWidth","getPageHeight","body","scrollHeight","documentElement","originList","slice","item","shift","m_search","m_readHistory","m_readFavor","swPostMessage","m_ability","m_promiseAjax","m_loadJS","catalogList","catalogDict","articleList","articleDict","sidebarList","bookList","bookDict","tagList","startTime","isPreload","markdownCacheName","sidebarName","getSidebarPath","articleModel","Model","result","idx","summary","content","setTimeout","editormd","markdownToHTML","markdown","htmlDecode","tocm","emoji","taskList","tex","flowChart","sequenceDiagram","innerHtml","html","baseHash","$0","$1","getName","match","getURL","o","encodeURI","origin","mtime","getPath","pathWithSearch","getNoSearch","getSortContent","paragraph","len","minLen","ret","substring","partCount","partIndex","$2","getContent","reg","split","filter","count","some","lastIndexOf","con","processItem","isRaw","trim","trigger","tfList","getTFs","preload","obj","totalList","concat","existDict","m","init","tagSet","processArticle","isDirectory","tags","encodeURIComponent","supportCache","caches","open","cache","resp","text","getLocal","sort","a","b","autoLoad","noContents","fetchContent","processCount","ajaxCache","getTagArticles","tag","retList","getReadTime","urlList","batchFetch","dataType","timeout","success","resList","getList","method","parseInt","start","getChildCatalog","catalog","tagLength","getCatalogArticles","getFavorArticles","isFavor","getFavorTime","testItem","testType","searchWeight","titleMatchDict","contentMatchDict","titleMathLength","pow","pointList","point","weight","startPoint","search","contentMathLength","searchList","word","isCommend","getGlobalRegex","fitList","remainList","ajaxList","searchCallback","resultList","table","totalNum","checkNum","searchWord","batchProcess","subList","testObj","searchDirect","getCatalogMessage","getCatalogs","getBooks","getTags","getArticleList","getListByCatalog","getListByTag","getListByFavor","getArticleContent","onUpdate","timer","clearTimeout","createNGram","n","end","gramDict","getWordList","wordList","processStrict","processChiese","apply","processEnglish","toLowerCase","removeStopWord","threeDict","fourDict","tfDict","hasOwnProperty","undefined","token","frequency","wordSet","RegExp","join","storageKey","readHistory","JSON","parse","localStorage","getItem","username","addHistory","setItem","stringify","hide","hasRead","host","isLocalhost","config","searchIssueURL","newIssueURL","update","author","logoTitle","CONFIG","nav","getConfigSync","getNewIssueURL","getSearchIssueURL","readFavor","addFavor","setLocal","permanent","delFavor","article","favor","val","index","postMessage","callbackDict","navigator","serviceWorker","addEventListener","event","cbid","req","controller","state","_fetch","options","defer","Deferred","xhrFields","withCredentials","useCache","isRight","storage","error","errors","promise","urls","promiseList","when","fetch","m_commonEvent","hideNavigator","height","viewInput","viewDrop","setView","template","viewGroup","getWord","doSearch","getHash","focus","selectLi","selectList","oldWord","keyCode","css","eq","show","getData","c_footer","c_mainContainer","m_initOption","c_pannel","c_pannelList","c_articleList","viewBody","viewTop","viewList","viewPannelList","addView","viewFoot","currentHash","hasRender","getCode","notRender","empty","hrefHead","pageNum","isInline","parent","prepend","anchorBack","scrollY","scrollTo","extendState","getPage","view","m_recommend","viewPannelBook","viewPannelCatalog","viewPannelTag","viewPannelRecommendPost","delay","getRecommend","source","itemSet","uniqList","currentPath","getCorrelation","a_tfList","b_tfList","total","reduce","sum","getSimilarArticles","calModel","weightList","getMutiSamples","tagDict","tagName","keys","j","delayTime","keyWords","alist","s_mainContainer","viewContent","viewSlidebar","slidebar","chapters","fileName","bindEvent","currentDom","c_content","m_pullArticle","container","viewRank","viewTips","full","keyWord","Notification","isSubscribed","fabPushElement","tipsElement","prev","isPushSupported","permission","unsubscribePush","subscribePush","ready","registration","pushManager","getSubscription","subscription","changePushStatus","catch","subscribe","userVisibleOnly","info","saveSubscriptionID","unsubscribe","deleteSubscriptionID","status","subscription_id","endpoint","Image","m_setting","autoCache","btnElement","changeStatus"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap b4cbac4fbdcfff6eb339","/**\n * @file index 入口文件，路由定义\n * @author ljquan@qq.com\n */\n//require(\"babel-polyfill\");  //太大了\nrequire(\"polyfill/\");\nrequire('helper/common_event.js');\n\nconst m_article = require('model/article');\nconst m_config = require('model/config');\nconst c_header = require('card/common/navigator');\nconst c_pageList = require('page/list.js');\nconst c_pageBook = require('page/book.js');\nconst c_pageContent = require('page/content.js');\nconst c_pageBlog = require('page/blog.js');\nconst c_pageSearch = require('page/search.js');\nconst c_setting = require('page/setting.js');\nlet viewHeader = c_header();\n$('body').append(viewHeader);\n\n// setInterval(function(){\n//     $.getJSON('/json/console.json', function(list){\n//         list = list || [];\n//         var item;\n//         while(item = list.shift()){\n//             console.log('[sw] ' + item);\n//         }\n//     });\n// }, 5E3);\n\nm_config.getConfig.then(() =>\n  m_article.initArticle.then(() => {\n    viewHeader.reset();\n    BCD.app({ //入口\n      setTitle: function (str) {\n        //viewHeader.reset();\n        let navLis = viewHeader.find('.nav li');\n        navLis.removeClass('active');\n        navLis.each((i, domLi) => {\n          let url = $($(domLi).find('a')[0]).attr('data-url') || '';\n          if (location.hash.indexOf(url) === 0) {\n            $(domLi).addClass('active');\n          }\n        });\n        document.title = str;\n      },\n      initPage: function (key, next) {\n        var page = this;\n        if (['index', 'favor', 'tag'].indexOf(key) > -1) {\n          c_pageList(page, key);\n          next();\n      }else if (key == 'setting') {\n          c_setting(page);\n          next();\n        } else if (key == 'blog') {\n          c_pageBlog(page);\n          next();\n        } else if (key == 'search') {\n          c_pageSearch(page, key);\n          next();\n        } else {\n          let path = decodeURIComponent(key);\n          if (m_article.hasBook(path)) {\n            c_pageBook(page, path);\n            return next();\n          } else if (m_article.hasCatalog(path)) {\n            c_pageList(page, path);\n            return next();\n          } else if (m_article.hasArticle(path)) {\n            c_pageContent(page, path);\n            return next();\n          }\n\n          BCD.replaceHash(m_config.getIndex());\n          next(-1);\n        }\n      }\n    });\n  })\n);\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/index.js","require(\"polyfill/array\");\nrequire(\"polyfill/set\");\nrequire(\"polyfill/object\");\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/polyfill/index.js","if (!Array.from) {\r\n  Array.from = function (arr) {\r\n    for (var i = 0, arr2 = []; i < arr.length; i++) {\r\n      arr2[i] = arr[i];\r\n    }\r\n    return arr2;\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/polyfill/array.js","if(!window.Set){\n\n    var Set = function(list){\n        Array.call(this);\n        list = list || [];\n        for(var i=0; i<list.length; i++){\n          this.add(list[i]);\n        }\n    }\n\n    Set.prototype = Object.create(Array.prototype);\n\n\n    // 集合添加元素\n    Set.prototype.add = function(data) {\n        if(this.indexOf(data) < 0){\n            this.push(data);\n            return true;\n        }\n        return false;\n    }\n\n    // 删除集合中的元素\n    Set.prototype.delete = function(data) {\n        var pos = this.indexOf(data);\n        if(pos > -1){\n            this.splice(pos,1);\n            return true;\n        }\n        return false;\n    }\n\n    // 判断集合是否包括元素\n    Set.prototype.has = function(data) {\n        if(this.indexOf(data) > -1){\n            return true;\n        }\n        return false;\n    }\n    // 获取集合的大小\n    Set.prototype.size = function() {\n        return this.length;\n    }\n\n    // 清除set集合。\n    Set.prototype.clear = function(set) {\n        while(this.pop());\n    }\n\n    Set.prototype.values = function(){\n        return\n    }\n    window.Set = Set;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/polyfill/set.js","if (!Object.assign) {\n  Object.assign = $.extend;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/polyfill/object.js","const m_util = require('common/util')\n//data-on=\"?m=go\" data-url=\"<%=o.href%>\"\n\nfunction onClick(name, fun){\n  if(fun){\n    BCD.addEvent(name, function(ele, option, data){\n      ele.on('click', function(e){\n        fun(ele, option, data);\n        m_util.stopBubble(e);\n      })\n    });\n  }\n}\n\nconst go = (ele, option, data)=>{\n    BCD.go(ele.data('url'));\n};\nonClick('go', go);\n//data-on=\"?m=back\"\nconst back = (ele, option, data)=>{\n  history.back();\n};\nonClick('back', back);\n\nconst replaceHash = (ele, option, data)=>{\n  BCD.replaceHash(ele.data('url'));\n};\nonClick('replaceHash', replaceHash);\n//事件绑定\nmodule.exports = {\n  onClick,\n  go,\n  back,\n  replaceHash\n};\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/helper/common_event.js","const m_event = require('./event');\nconst getTime = function(date) {\n  date = new Date(date);\n  var now = new Date();\n  var diff = now - date;\n  switch (true) {\n    case diff < 6E4:\n      return '刚刚';\n    case diff < 36E5:\n      return Math.round(diff / 6E4) + '分钟前';\n    case diff < 864E5:\n      return Math.round(diff / 36E5) + '小时前';\n    case diff < 1728E5 && now.getDate() - date.getDate() != 2:\n      return '昨天';\n    case date.getFullYear() === new Date().getFullYear():\n      return BCD.time.formatDate(date, \"%M月%d日\");\n    default:\n      return BCD.time.formatDate(date, \"%y年%M月%d日\");\n  }\n};\n\nconst leftFillString = function(num, length) {\n  return (\"0000000000\" + num).substr(-length);\n};\nconst getRandomName = function() {\n  return (\"aaaaaaaaaa\" + Math.random().toString(36).replace(/[.\\d]/g, '')).substr(-10)\n};\n\n//https://developers.google.com/web/tools/lighthouse/audits/date-now\nlet _date = window.performance || Date;\nmodule.exports = {\n  getTime,\n  leftFillString,\n  getRandomName,\n  stopBubble: m_event.stopBubble,\n  stopBubbleEx: m_event.stopBubbleEx,\n  now: function(){\n      return _date.now();\n  },\n  load: require('./load.js'),\n  dom: require('./dom'),\n  iterator: require('./iterator.js')\n};\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/common/util/index.js","/**\r\n * @module {Object} event  事件相关的处理函数\r\n * @return {object} 方法集合\r\n * @property {function} stopBubble 停止冒泡并禁止默认事件\r\n * @property {function} stopBubbleEx 停止冒泡\r\n * @author ljquan@qq.com\r\n */\r\n\r\nmodule.exports = {\r\n    /**\r\n     * 停止冒泡并禁止默认事件\r\n     * @param  {event} e 事件\r\n     * @return {null}\r\n     */\r\n    stopBubble: function(e) {\r\n        if (e && e.stopPropagation) {\r\n            e.stopPropagation();\r\n        }\r\n        e.preventDefault();\r\n    },\r\n    /**\r\n     * 停止冒泡\r\n     * @param  {event} e 事件\r\n     * @return {null}\r\n     */\r\n    stopBubbleEx: function(e) {\r\n        if (e && e.stopPropagation) {\r\n            e.stopPropagation();\r\n        }\r\n    }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/common/util/event.js","let scriptDict = {};\nwindow.LOAD_CALLBACK = function (ele, callback) {\n  console.log(arguments);\n};\n\nmodule.exports = function (list, callback) {\n  let promiseLoad = new Promise(function(resolve){\n     if(!callback){\n         callback = resolve;\n     }\n  });\n  let head = document.getElementsByTagName('head')[0];\n  let loadList = [];\n  if (BCD.is.s(list)) {\n    list = [list];\n  }\n  list = list.map(src => {\n    src = BCD.url.abs(src);\n    if (!scriptDict[src]) {\n      loadList.push(src);\n    }\n    return src;\n  });\n\n  if(loadList.length){\n    loadList.forEach(src =>{\n      let loadDom;\n      if (/\\.js$/.test(src)) {\n        loadDom = document.createElement('script');\n        loadDom.type = 'text/javascript';\n        loadDom.charset = 'utf-8';\n        loadDom.async = false;\n        loadDom.src = src;\n      } else {\n        loadDom = document.createElement('link');\n        loadDom.rel = 'stylesheet';\n        loadDom.href = src;\n      }\n\n      loadDom.onload = function () {\n        scriptDict[src] = true;\n        if (loadList.every(src => scriptDict[src])) {\n          callback(list.map(src=>scriptDict[src]));\n        }\n      };\n      head.appendChild(loadDom);\n    });\n  }else{\n    callback(list.map(src=>scriptDict[src]));\n  }\n  return promiseLoad;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/common/util/load.js","module.exports = {\r\n  getWindowHeight: function () {\r\n    return window.innerHeight || window.clientHeight;\r\n  },\r\n  getWindowWidth: function () {\r\n    return window.innerWidth;\r\n  },\r\n  getPageHeight: function () {\r\n    return document.body.scrollHeight || document.documentElement.scrollHeight;\r\n  }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/common/util/dom.js","module.exports = function iterator(originList, callback) {\r\n  if (originList && originList.length) {\r\n    var list = originList.slice();\r\n    var item = list.shift();\r\n    var next = function () {\r\n      iterator(list, callback);\r\n    };\r\n    callback(item, next, list);\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/common/util/iterator.js","const m_util = require('common/util/index');\r\nconst m_search = require('helper/search');\r\nconst m_readHistory = require('model/read_history');\r\nconst m_readFavor = require('model/read_favor');\r\nconst swPostMessage = require('helper/sw_post_message.js');\r\nconst m_ability = require('helper/ability.js');\r\nconst m_promiseAjax = require('helper/promise_ajax.js');\r\nconst m_loadJS = require('helper/load_lib');\r\nlet catalogList = []; //目录列表\r\nlet catalogDict = {};\r\nlet articleList = []; //文件列表\r\nlet articleDict = {};\r\nlet sidebarList = []; //sidebar文件列表(sidebar文件也可以在articleDict中索引到)\r\nlet bookList = []; //书籍列表\r\nlet bookDict = {};\r\nlet tagList = [];\r\nlet startTime = m_util.now();\r\nlet isPreload = false;\r\nconst markdownCacheName = 'swblog-markdown';\r\nconst sidebarName = '$sidebar$';\r\nconst getSidebarPath = (path) => path + '/' + sidebarName + '.md';\r\nconst articleModel = new BCD.Model(articleDict);\r\n\r\nBCD.addEvent('mkview', function (ele, option, data) {\r\n  let name = m_util.getRandomName();\r\n  let result;\r\n  if ('idx' in option) {\r\n    let item = data.list[option.idx];\r\n    result = item.summary;\r\n    if (result.length < item.content.length) {\r\n      result += '...';\r\n    }\r\n  } else {\r\n    result = data.content;\r\n  }\r\n\r\n  ele.attr('id', name);\r\n  setTimeout(function () { //dom元素展示出来之后再绑定，不然流程图等会有样式问题\r\n    m_loadJS.then(function () {\r\n      editormd.markdownToHTML(name, {\r\n        markdown: result, //+ \"\\r\\n\" + $(\"#append-test\").text(),\r\n        // htmlDecode: true, // 开启 HTML 标签解析，为了安全性，默认不开启\r\n        htmlDecode: \"style,script,iframe\", // you can filter tags decode\r\n        //toc             : false,\r\n        tocm: true, // Using [TOCM]\r\n        //tocContainer    : \"#custom-toc-container\", // 自定义 ToC 容器层\r\n        //gfm             : false,\r\n        //tocDropdown     : true,\r\n        // markdownSourceCode : true, // 是否保留 Markdown 源码，即是否删除保存源码的 Textarea 标签\r\n        emoji: true,\r\n        taskList: true,\r\n        tex: true, // 默认不解析\r\n        flowChart: true, // 默认不解析\r\n        sequenceDiagram: true // 默认不解析\r\n      });\r\n\r\n      let innerHtml = ele.html();\r\n      if (/(<br>|<p><\\/p>){2,}/.test(innerHtml)) {\r\n        ele.html(innerHtml.replace(/(<br>|<p><\\/p>){2,}/, ''));\r\n      }\r\n\r\n      if (result.indexOf('[TOC]') > -1 && location.hash.indexOf('.md') > 0) { //兼容TOC目录\r\n        let baseHash = location.hash.replace(/\\.md\\/.*/, '.md');\r\n        ele.html(ele.html()\r\n          .replace(/href=\"#([^\"]*)/g, function ($0, $1) {\r\n            if ($1) {\r\n              return 'href=\"' + baseHash + '/' + $1;\r\n            }\r\n            return $0\r\n          }).replace(/name=\"([^\"]*)/g, function ($0, $1) {\r\n            if ($1) {\r\n              return 'name=\"' + baseHash.substr(1) + '/' + $1;\r\n            }\r\n            return $0\r\n          }));\r\n      }\r\n      $('a[href^=\"http\"]').attr('target', '_blank');\r\n      $('a[href^=\"http\"]').attr('rel', 'noopener');\r\n    })\r\n  }, 0);\r\n});\r\n\r\nconst getName = (path) => {\r\n  let arr = path.match(/\\/([^/.]+)[.\\w-_]+$/);\r\n  return arr ? arr[1] : '';\r\n}\r\n\r\nconst getURL = (o) => encodeURI(location.origin + '/' + o.path + '?t=' + o.mtime);\r\nconst getPath = (pathWithSearch) => decodeURIComponent(pathWithSearch.replace(location.origin + '/', '').replace(/\\?[^?]+/, ''));\r\nconst getNoSearch = function (url) {\r\n  return url.replace(/\\?[^?]+/, '');\r\n}\r\n\r\nconst getSortContent = (content, paragraph = 10) => {\r\n  let len = 500;\r\n  let minLen = len / 2;\r\n  let ret = content.substring(0, len);\r\n  let partCount = 0;\r\n  let partIndex = 0;\r\n  ret.replace(/([^\\n]*)(\\n|<br>|<\\/p>)/g, function ($0, $1, $2, idx) {\r\n    partCount++;\r\n    if (partCount > paragraph && $1.length > 10 && partIndex === 0) {\r\n      partIndex = idx;\r\n    }\r\n    if (partCount == 15 && partIndex === 0) {\r\n      partIndex = idx;\r\n    }\r\n  });\r\n  if (partIndex > 0) {\r\n    ret = ret.substring(0, partIndex);\r\n    if (ret.length < len * 0.7) {\r\n      return ret;\r\n    }\r\n  }\r\n  let getContent = (str, reg) => {\r\n    let arr = str.split(reg).filter(o => !!o);\r\n    let count = 0;\r\n    if (arr && arr.length > 2) {\r\n      let idx = arr.length - 1;\r\n      if (arr.some((o, i) => {\r\n          count += o.length;\r\n          if (count > minLen && i > 1) {\r\n            idx = i;\r\n            return true;\r\n          }\r\n        })) {\r\n        return str.substr(0, str.lastIndexOf(arr[idx])).replace(/[#\\s]+$/, '');\r\n      }\r\n      return str;\r\n    }\r\n  }\r\n  let con = getContent(ret, /\\s*#+\\s*/);\r\n  if (con) {\r\n    return con;\r\n  }\r\n  con = getContent(ret, /\\s+/);\r\n  if (con) {\r\n    return con;\r\n  }\r\n  return ret;\r\n}\r\n\r\nconst processItem = (item, content) => {\r\n  if(!content){\r\n      return;\r\n  }\r\n  if (item.title == sidebarName) {\r\n    item.content = content;\r\n    return item;\r\n  }\r\n  let isRaw = true;\r\n  // let start = content.indexOf('---');\r\n  // if(start>-1){\r\n  //   let end;\r\n  //   if(start===0){\r\n  //     start = start+3;\r\n  //     end = content.substring(start).indexOf('---') + start;\r\n  //   }else{\r\n  //     end = start;\r\n  //     start = 0;\r\n  //   }\r\n  //   let arr = content.substring(start, end).match(/([^:\\n]+:[^\\n]+)/g);\r\n  //   if(arr){\r\n  //     let attrDict = {};\r\n  //     arr.forEach(function(o){\r\n  //       let point = o.indexOf(':');\r\n  //       attrDict[o.substring(0, point)] = o.substring(point+1);\r\n  //     });\r\n  //     item.title = attrDict.title || item.title;\r\n  //     isRaw = false;\r\n  //     content = content.substring(end+3).trim();\r\n  //     if(attrDict.dest_url){\r\n  //       content = '链接：['+attrDict.dest_url+']('+attrDict.dest_url+')'\r\n  //     }\r\n  //   }\r\n  // }\r\n  if (isRaw) {\r\n    let arr = content.match(/^[\\s]*#[^\\n\\(]+[\\n]/);\r\n    if (arr) {\r\n      let title = arr[0];\r\n      item.title = title.replace(/[#\\s]+/, '').trim();\r\n      content = content.replace(title, '');\r\n      isRaw = false;\r\n    }\r\n  }\r\n  articleModel.trigger('update_content');\r\n  item.content = content; // = (content || '').replace(/^[\\s]*---[-]*/, '');\r\n  item.tfList = m_search.getTFs(content);\r\n  item.summary = getSortContent(content);\r\n  return item;\r\n};\r\n\r\nconst preload = (obj) => {\r\n  let count = 0;\r\n  for (var pathWithSearch in obj) {\r\n    let path = getPath(pathWithSearch);\r\n    let item;\r\n    if (item = articleDict[path]) {\r\n      count++;\r\n      processItem(item, obj[pathWithSearch]);\r\n    }\r\n  }\r\n  let totalList = sidebarList.concat(articleList);\r\n  let existDict = {};\r\n  totalList.forEach(o => {\r\n    existDict[location.origin + '/' + o.path] = 1;\r\n  });\r\n\r\n  swPostMessage({\r\n    m: 'delete_not_exist_article',\r\n    data: existDict\r\n  });\r\n\r\n\r\n  if (isPreload) {\r\n    if (count) {\r\n      console.log('文章同步成功（' + count + '篇）！可以离线使用');\r\n    } else {\r\n      console.log('文章同步成功!（无更新内容）');\r\n    }\r\n    return false;\r\n  } else {\r\n    isPreload = true;\r\n    console.log('本地文章加载成功（' + count + '/' + (articleList.length + sidebarList.length) + '个文件）');\r\n  }\r\n  return true;\r\n};\r\n\r\nconst init = (list) => {\r\n  catalogList = []; //目录列表\r\n  articleList = []; //文件列表\r\n  sidebarList = [];\r\n  bookList = [];\r\n  let tagSet = new Set();\r\n  let processArticle = (o) => {\r\n    let {\r\n      path = '', mtime\r\n    } = o;\r\n    if (o.isDirectory) {\r\n      let tags = path.split('/').slice(1);\r\n      tags.forEach(o => tagSet.add(o));\r\n      let item = {\r\n        path,\r\n        time: m_util.getTime(mtime),\r\n        href: '#!/' + encodeURIComponent(o.path),\r\n        title: path.slice(path.lastIndexOf('/') + 1),\r\n        tagList: tags\r\n      };\r\n      catalogList.push(item);\r\n    } else {\r\n      let tags = path.split('/').slice(1, -1);\r\n      tags.forEach(o => tagSet.add(o));\r\n      let item = {\r\n        path,\r\n        mtime,\r\n        href: '#!/' + encodeURIComponent(o.path),\r\n        title: getName(path),\r\n        time: m_util.getTime(mtime),\r\n        tagList: tags\r\n      };\r\n\r\n\r\n\r\n\r\n      if (m_ability.supportCache) {\r\n        caches.open(markdownCacheName).then(function (cache) {\r\n          //取旧缓存\r\n          return cache.match(getURL(item)).then(function (resp) {\r\n            return resp && resp.text();\r\n          }).then(function (text) {\r\n            if (text) {\r\n              item = processItem(item, text);\r\n            }\r\n          });\r\n        });\r\n      } else {\r\n        let content = BCD.cache.getLocal(o.path);\r\n        if (content) {\r\n          item = processItem(item, content);\r\n        }\r\n      }\r\n\r\n      if (articleDict[path]) {\r\n        item = $.extend(articleDict[path], item);\r\n      } else {\r\n        articleDict[path] = item;\r\n      }\r\n\r\n      articleList.push(item);\r\n    }\r\n  };\r\n  list.forEach(processArticle);\r\n  articleList = articleList.filter(o => {\r\n    if (o.title == sidebarName) {\r\n      sidebarList.push(o);\r\n      return false;\r\n    }\r\n    return true;\r\n  });\r\n  catalogList = catalogList.filter(o => {\r\n    if (articleDict[getSidebarPath(o.path)]) {\r\n      bookDict[o.path] = o;\r\n      bookList.push(o);\r\n      return false;\r\n    }\r\n    catalogDict[o.path] = o;\r\n    return true;\r\n  });\r\n  articleList = articleList.sort((a, b) => {\r\n    return b.mtime - a.mtime;\r\n  });\r\n  tagList = [...tagSet];\r\n};\r\n\r\nconst autoLoad = function(){\r\n  var totalList = sidebarList.concat(articleList);\r\n  var noContents = totalList.filter(function(o){\r\n      return !o.content;\r\n  });\r\n  m_util.iterator(noContents, function(item, next, list){\r\n      fetchContent([item]).then(next);\r\n  });\r\n}\r\n\r\nlet processCount = 0;\r\n//先用缓存，请求回来再更新\r\nconst initArticle = new Promise((resolve) => {\r\n  BCD.ajaxCache('./json/article.json', (data) => {\r\n    init(data);\r\n    processCount++;\r\n    // if (processCount === 2) { //如果网络请求失败，这里不会被执行\r\n    //   let totalList = sidebarList.concat(articleList);\r\n    //   swPostMessage({\r\n    //     m: 'preloadAtricle',\r\n    //     data: totalList.map(getURL)\r\n    //   }, preload);\r\n    // }\r\n    resolve(articleList);\r\n    return data && 1; //缓存数据到localStorage\r\n  }, 0, 2E3, true);\r\n});\r\n\r\n//获取包含相关tag文章列表\r\nconst getTagArticles = (tag) => {\r\n  var retList = articleList;\r\n  if (tag) {\r\n    retList = articleList.filter(o => o.tagList &&\r\n      o.tagList.indexOf(tag) > -1);\r\n  }\r\n  return retList.sort(function (a, b) {\r\n    return (b.mtime - (m_readHistory.getReadTime(b.path) || 0)) - (a.mtime - (m_readHistory.getReadTime(a.path) || 0));\r\n  });;\r\n};\r\n\r\nconst fetchContent = (list) => {\r\n  let urlList = list.filter(o => articleDict[o.path] && !articleDict[o.path].content).map(getURL);\r\n  return m_promiseAjax.batchFetch(urlList, {\r\n    dataType: 'text',\r\n    cache: m_ability.supportCache ? '' : 'normal_local',\r\n    timeout: 5E3,\r\n    success: function (str) {\r\n      return !!str;\r\n    }\r\n  }).then(function (resList) {\r\n    for (var i = 0; i < (resList || []).length; i++) {\r\n      var o = list[i];\r\n      if (o) {\r\n        articleDict[o.path] = processItem(o, resList[i]);\r\n      }\r\n    }\r\n  });\r\n};\r\n\r\n\r\nconst getList = (method) => (tag, page = 0, count = 10) => {\r\n  page = parseInt(page || 0);\r\n  let start = page * count;\r\n  let totalList = method(tag);\r\n  let list = totalList.slice(start, start + count);\r\n  return fetchContent(list).then(() => {\r\n    return {\r\n      tag,\r\n      page,\r\n      count,\r\n      num: totalList.length,\r\n      list: list.map(o => articleDict[o.path]).filter(o => !!(o && o.content))\r\n    };\r\n  });\r\n};\r\n\r\nconst getChildCatalog = (path) => {\r\n  let catalog = catalogDict[path];\r\n  if (catalog) {\r\n    let tagList = catalog.tagList;\r\n    let tagLength = tagList.length + 1;\r\n    return bookList.concat(catalogList).filter(o => o.tagList.length &&\r\n      tagList.every((tag, i) => o.tagList.length == tagLength && tag == o.tagList[i]));\r\n  }\r\n  return [];\r\n};\r\n\r\nconst getCatalogArticles = (path) => {\r\n  let catalog = catalogDict[path];\r\n  if (catalog) {\r\n    let tagList = catalog.tagList;\r\n    return articleList.filter(o => o.tagList.length &&\r\n      tagList.every((tag, i) => tag == o.tagList[i])).sort((a, b) => a.tagList.length - b.tagList.length);\r\n  }\r\n  return [];\r\n};\r\nconst getFavorArticles = () => {\r\n  return articleList.filter(o => m_readFavor.isFavor(o.path)).sort((a, b) => m_readFavor.getFavorTime(b.path) - m_readFavor.getFavorTime(a.path));\r\n};\r\n\r\nconst testItem = (reg, item) => {\r\n  let testType = 0;\r\n  let obj = {};\r\n  let searchWeight = 0;\r\n  let titleMatchDict = {};\r\n  let contentMatchDict = {};\r\n  if (reg.test(item.title)) {\r\n    obj.title = item.title.replace(reg, function ($0) {\r\n      if (titleMatchDict[$0]) {\r\n        titleMatchDict[$0]++;\r\n      } else {\r\n        titleMatchDict[$0] = 1;\r\n      }\r\n      return '<span class=\"text-danger\">' + $0 + '</span>';\r\n    });\r\n    testType += 1;\r\n    let titleMathLength = 0;\r\n    for (var key in titleMatchDict) {\r\n      titleMathLength += /\\w/.test(key) ? titleMatchDict[key] : Math.pow(1.6, key.length - 1) * titleMatchDict[key];\r\n    }\r\n    searchWeight += titleMathLength / item.title.length;\r\n  }\r\n  if (item.content && reg.test(item.content)) {\r\n    let pointList = [];\r\n    obj.content = item.content.replace(reg, function ($0, point) {\r\n      if (contentMatchDict[$0]) {\r\n        contentMatchDict[$0]++;\r\n      } else {\r\n        contentMatchDict[$0] = 1;\r\n      }\r\n      let weight = /\\w/.test($0) ? 2 : $0.length;\r\n      pointList.push({\r\n        point,\r\n        weight\r\n      });\r\n      return '<font color=#a94442>' + $0 + '</font>';\r\n    });\r\n    pointList = pointList.sort((a, b) => b.weight - a.weight);\r\n    let startPoint = pointList[0].point;\r\n    let start = startPoint - 30;\r\n    let summary = item.content.substr(start < 0 ? 0 : start);\r\n    start = summary.search(/[。\\n\\r]/);\r\n    if (start < startPoint) {\r\n      summary = getSortContent(summary.substr(start).replace(/^[。\\s]*/, ''), 5);\r\n    } else {\r\n      summary = getSortContent(summary.replace(/^[。\\s]*/, ''), 5);\r\n    }\r\n    obj.summary = summary.replace(reg, function ($0) {\r\n      return '<font color=#a94442>' + $0 + '</font>';\r\n    });\r\n    testType += 2;\r\n    let contentMathLength = 0;\r\n\r\n    for (var key in contentMatchDict) {\r\n      contentMathLength += /\\w/.test(key) ? contentMatchDict[key] : Math.pow(1.6, key.length - 1) * contentMatchDict[key];\r\n    }\r\n    searchWeight += contentMathLength / Math.pow(item.content.length, 0.6);\r\n  }\r\n  obj.testType = testType;\r\n  /*******calculate search weight**********/\r\n\r\n  obj.searchWeight = searchWeight;\r\n  return Object.assign({}, item, obj);\r\n};\r\n\r\n\r\nconst searchList = (word, callback, isCommend = false) => {\r\n  let reg = m_search.getGlobalRegex(word);\r\n  let fitList = [];\r\n  let remainList = [];\r\n  let ajaxList = [];\r\n  let totalList = articleList.filter(o => o);\r\n\r\n  const searchCallback = (list) => {\r\n    let resultList = list.filter(o => o.testType > 0).sort((a, b) => {\r\n      let ret = b.searchWeight - a.searchWeight;\r\n      if (ret === 0) {\r\n        return b.content.length - a.content.length + (b.mtime - a.mtime) / 1E5;\r\n      }\r\n      return ret;\r\n    });\r\n    if (resultList.length || list.length >= totalList.length) {\r\n      console.table(resultList.map(o => {\r\n        return {\r\n          path: o.path,\r\n          searchWeight: o.searchWeight\r\n        };\r\n      }));\r\n    }\r\n    callback({\r\n      totalNum: totalList.length,\r\n      checkNum: list.length,\r\n      searchWord: word,\r\n      list: resultList\r\n    });\r\n  };\r\n  const batchProcess = (list, next) => {\r\n    let subList = list.splice(0, 10);\r\n    fetchContent(subList).then(() => {\r\n      searchCallback(subList.map(o => testItem(reg, articleDict[o.path])));\r\n      if (list.length) {\r\n        batchProcess(list, next);\r\n      } else if (next) {\r\n        next();\r\n      }\r\n    })\r\n  };\r\n  totalList.forEach(o => {\r\n    let item = articleDict[o.path];\r\n    if (item) {\r\n      let testObj = testItem(reg, item);\r\n      if (item.content) {\r\n        fitList.push(testObj);\r\n      } else if (testObj.testType > 0) {\r\n        ajaxList.push(item);\r\n      } else {\r\n        remainList.push(o);\r\n      }\r\n    }\r\n  });\r\n  if (isCommend) {\r\n    return callback(ajaxList.concat(fitList).filter(o => o.testType > 0).sort((a, b) => b.searchWeight - a.searchWeight));\r\n  }\r\n  searchCallback(fitList);\r\n  batchProcess(ajaxList, function () {\r\n    batchProcess(remainList);\r\n  })\r\n  return remainList;\r\n};\r\n\r\n\r\n\r\n//搜索直达\r\nconst searchDirect = (word) => {\r\n  let reg = m_search.getGlobalRegex(word);\r\n  return articleList.filter(o => reg.test(o.title)).map(o => {\r\n    let weight = 0;\r\n    let item = {\r\n      href: o.href,\r\n      title: o.title.replace(reg, function ($0) {\r\n        weight += $0.length;\r\n        return '<span class=\"text-danger\">' + $0 + '</span>';\r\n      })\r\n    };\r\n    item.weight = weight\r\n    return item;\r\n  }).sort((a, b) => b.weight - a.weight);\r\n};\r\n\r\n\r\nmodule.exports = {\r\n  getName,\r\n  isPreload,\r\n  startTime,\r\n  initArticle,\r\n  catalogDict,\r\n  articleDict,\r\n  hasCatalog: (path) => !!catalogDict[path],\r\n  hasArticle: (path) => !!articleDict[path],\r\n  hasBook: (path) => !!bookDict[path],\r\n  getCatalogMessage: (path) => catalogDict[path],\r\n  getCatalogs: () => catalogList,\r\n  getBooks: () => bookList,\r\n  getTagArticles,\r\n  getTags: () => tagList,\r\n  getSidebarPath,\r\n  getArticleList: () => articleList.map(o => articleDict[o.path]),\r\n  getListByCatalog: getList(getCatalogArticles),\r\n  getChildCatalog,\r\n  getListByTag: getList(getTagArticles),\r\n  getListByFavor: getList(getFavorArticles),\r\n  getArticleContent: (path) => fetchContent([articleDict[path]])\r\n    .then(() => articleDict[path]),\r\n  searchDirect,\r\n  searchList,\r\n  autoLoad,\r\n  onUpdate: function(callback){\r\n      var timer;\r\n      articleModel.on('update_content', function(){\r\n          clearTimeout(timer);\r\n          timer = setTimeout(callback, 100);\r\n      });\r\n  }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/model/article.js","\r\n'use strict';\r\n\r\nconst createNGram = (n) => (str) => {\r\n  let arr = [];\r\n  let end = str.length - n + 1;\r\n  for (var i = 0; i < end; i++) {\r\n    arr.push(str.substr(i, n));\r\n  }\r\n  return arr;\r\n}\r\n\r\nconst gramDict = {\r\n  4: createNGram(4),\r\n  3: createNGram(3),\r\n  2: createNGram(2)\r\n};\r\n\r\nconst getWordList = (str = '') => {\r\n  let wordList = [str];\r\n  let processStrict = (str) => str.replace(/['‘’][^'‘’]*['‘’]|[\"”“][^\"”“]*[\"”“]/g, function($0) {\r\n    wordList.push($0.replace(/['‘’\"”“]/g, ''));\r\n    return ' ';\r\n  });\r\n\r\n\r\n  let processChiese = (str) => str.replace(/[\\u4e00-\\u9fff\\uf900-\\ufaff]+/g, function($0) {\r\n    wordList.push($0);\r\n    for (var i = 4; i > 1; i--) {\r\n      if ($0.length > i) {\r\n        wordList.push.apply(wordList, gramDict[i]($0));\r\n      }\r\n    }\r\n    return ' ';\r\n  });\r\n\r\n  let processEnglish = (str) => {\r\n    wordList.push.apply(wordList,\r\n      str.split(/[^a-zA-Z]/)\r\n      .filter(o => o.length > 2)\r\n      .map(o => o.toLowerCase()));\r\n  };\r\n\r\n  processEnglish(processChiese(processStrict(str)));\r\n  //console.log('search RegExp', new RegExp(wordList.join('|'), 'ig'));\r\n  return wordList;\r\n};\r\n\r\nconst removeStopWord = (str) => {\r\n  str = str.replace(/\\s*```([^`\\n\\r]*)[^`]*```\\s*/g, function($0, $1){return ' '+$1+' ';}); //去掉代码\r\n  str = str.replace(/<[^\\u4e00-\\u9fff\\uf900-\\ufaff>]+>|\\([^\\u4e00-\\u9fff\\uf900-\\ufaff)]+\\)|\\w+[:@][\\w.?#=&\\/]+/g, ' ');//去掉html标签及超链接\r\n  str = str.replace(/怎么|的|是|开始|很多|我|觉得|非常|可以|一|了|上面|下面|这|那|哪|个|this|return|with/g, ' '); //去停用词\r\n  str = str.replace(/[^\\u4e00-\\u9fff\\uf900-\\ufaff\\w]/g, ' '); //非中文或英文，替换成空格\r\n  return str;\r\n}\r\n\r\nconst getTFs = (str = '') => {\r\n  let wordList = getWordList(removeStopWord(str)).slice(1);\r\n  let threeDict = {};\r\n  let fourDict = {};\r\n  let tfDict = {};\r\n  let tfList = [];\r\n\r\n  wordList.forEach(o => {\r\n    if (o.length < 2 || Object.hasOwnProperty(o) || (tfDict[o]!==undefined && typeof tfDict[o] !=='number')) {\r\n      return;\r\n    }\r\n    if (tfDict[o]) {\r\n      tfDict[o]++;\r\n    } else {\r\n      if (o.length == 3) {\r\n        threeDict[o] = 1;\r\n      }\r\n      if (o.length == 4) {\r\n        fourDict[o] = 1;\r\n      }\r\n      tfDict[o] = 1;\r\n    }\r\n  });\r\n  var token;\r\n  //去掉非词\r\n  for (token in fourDict) {\r\n    let frequency = tfDict[token];\r\n    gramDict[3](token).forEach(o => {\r\n      if (frequency === tfDict[o]) {\r\n        delete tfDict[o];\r\n        delete threeDict[o];\r\n        gramDict[2](o).forEach(item => {\r\n          if (frequency === tfDict[item]) {\r\n            delete tfDict[item];\r\n          }\r\n        });\r\n      }\r\n    });\r\n  }\r\n  for (token in threeDict) {\r\n    let frequency = tfDict[token];\r\n    gramDict[2](token).forEach(o => {\r\n      if (frequency === tfDict[o]) {\r\n        delete tfDict[o];\r\n      }\r\n    });\r\n  }\r\n\r\n  for (token in tfDict) {\r\n    tfList.push({\r\n      token,\r\n      frequency: tfDict[token]\r\n    });\r\n  }\r\n  return tfList.sort((a, b) => b.frequency - a.frequency);//.slice(0,10).map(o=>o.token);\r\n}\r\n\r\nmodule.exports = {\r\n  getWordList,\r\n  getTFs,\r\n  getGlobalRegex: (str) => {\r\n    let wordSet = new Set(getWordList(str));\r\n    let wordList = [...wordSet];\r\n    return new RegExp(wordList.join('|'), 'ig');\r\n  }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/helper/search.js","const m_config = require('model/config');\nlet storageKey = 'read_history';\nlet readHistory = {};\nconst init = ()=> {\n  try{\n    readHistory = $.extend({}, JSON.parse(localStorage.getItem(storageKey)), readHistory);\n  }catch(e){}\n};\n\nm_config.getConfig.then(()=>{\n  storageKey = 'read_history_' + m_config.username;\n  init();\n})\n\nconst addHistory = (path)=>{\n  readHistory[path] = Date.now();\n  localStorage.setItem(storageKey, JSON.stringify(readHistory));\n};\n\nBCD.addEvent('article_down', function(ele){\n  ele.on('click', function(e){\n    ele.hide();\n    addHistory(ele.data('url'));\n  });\n});\n\nmodule.exports = {\n  addHistory,\n  hasRead: (path)=> !!readHistory[path],\n  getReadTime: (path)=> readHistory[path]\n};\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/model/read_history.js","let arr = location.host.split(\".\");\r\nlet isLocalhost = arr.length === 1;\r\nlet username = isLocalhost ? \"swblog\" : arr[0];\r\nlet config = {\r\n  \"author\": username,\r\n  \"nav\": [\r\n    [\"Home\", \"#!/index\"],\r\n    [\"About\", \"#!/blog/about.md\"]\r\n  ]\r\n};\r\nlet searchIssueURL;\r\nlet newIssueURL;\r\n\r\nconst update = () => {\r\n  let author = username = config.author;\r\n  config.logoTitle = config.logoTitle || author + \"的博客\";\r\n  searchIssueURL = 'https://github.com/' + author + '/' + author + '.github.io/issues?utf8=%E2%9C%93&q=';\r\n  newIssueURL = 'https://github.com/' + author + '/' + author + '.github.io/issues/new?title=';\r\n  if (window.CONFIG) {\r\n    CONFIG.username = username;\r\n  }\r\n};\r\nupdate();\r\n\r\n//先用缓存，请求回来再更新\r\nconst getConfig = new Promise((resolve) => {\r\n  BCD.ajaxCache('./json/config.json', (data) => {\r\n    config = data || config;\r\n    if (config.author) {\r\n      update();\r\n      resolve();\r\n      return 1; //缓存数据到localStorage\r\n    }\r\n    resolve();\r\n  }, 0, 2E3, true);\r\n});\r\n\r\n\r\n\r\n\r\nwindow.CONFIG = module.exports = {\r\n  username,\r\n  getIndex: () => config.nav && config.nav[0] && config.nav[0][1] || \"\",\r\n  isLocalhost,\r\n  getConfigSync: () => config,\r\n  getConfig,\r\n  getNewIssueURL: (title) => newIssueURL + decodeURIComponent(isLocalhost ? \"localhost测试评论\" : title),\r\n  getSearchIssueURL: (title) => newIssueURL + decodeURIComponent(isLocalhost ? \"localhost测试评论\" : title)\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/model/config.js","const m_config = require('model/config');\nlet storageKey = 'read_favor';\nlet readFavor = {};\nconst init = ()=> {\n  try{\n    readFavor = $.extend({}, BCD.cache.getLocal(storageKey), readFavor);\n  }catch(e){}\n};\n\nm_config.getConfig.then(()=>{\n  storageKey = 'read_favor_' + m_config.username;\n  init();\n})\n\nconst addFavor = (path)=>{\n  readFavor[path] = Date.now();\n  BCD.cache.setLocal(storageKey, readFavor, {permanent: true});\n};\n\nconst delFavor = (path)=>{\n  if(path in readFavor){\n    delete readFavor[path];\n    BCD.cache.setLocal(storageKey, readFavor, {permanent: true});\n  }\n};\n\nconst isFavor = (path)=> !!readFavor[path];\n\nBCD.addEvent('favor', function(ele, option, data){\n  let article = data;\n  if(('idx' in option) && data.list){\n    article = data.list[option.idx];\n  }\n  let favor = isFavor(article.path);\n  ele.val(favor);\n  if(favor){\n    ele.removeClass('glyphicon-star-empty').addClass('glyphicon-star');\n  }\n  ele.on('click', function(){\n    if(ele.val()){\n      ele.removeClass('glyphicon-star').addClass('glyphicon-star-empty');\n      delFavor(article.path);\n      ele.val(false);\n    }else{\n      ele.removeClass('glyphicon-star-empty').addClass('glyphicon-star');\n      addFavor(article.path);\n      ele.val(true);\n    }\n  });\n});\n\nmodule.exports = {\n  addFavor,\n  delFavor,\n  isFavor,\n  getFavorTime: (path)=> readFavor[path]\n};\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/model/read_favor.js","const m_util = require('common/util');\r\n\r\nlet index = 0;\r\nlet postMessage = function () {};\r\nlet callbackDict = {\r\n  log: function (resp) {\r\n    console.log.apply(this, resp);\r\n    return true;\r\n  }\r\n};\r\n\r\nif (navigator.serviceWorker) {\r\n  window.addEventListener('message', function (event) {\r\n    var data = JSON.parse(event.data);\r\n    var cbid = data.cbid,\r\n      resp = data.resp;\r\n    if (cbid && callbackDict[cbid]) {\r\n      console.log('[client] window message:' + cbid);\r\n      if (!callbackDict[cbid](resp)) {\r\n        delete callbackDict[cbid];\r\n      }\r\n    }\r\n  });\r\n  navigator.serviceWorker.addEventListener('message', function (event) {\r\n    var data = JSON.parse(event.data);\r\n    var cbid = data.cbid,\r\n      resp = data.resp;\r\n    if (cbid && callbackDict[cbid]) {\r\n      console.log('[client] serviceWorker message:' + cbid);\r\n      if (!callbackDict[cbid](resp)) {\r\n        delete callbackDict[cbid];\r\n      }\r\n    }\r\n    m_util.stopBubble(event);\r\n  }); //页面通过监听service worker的message事件接收service worker的信息\r\n  postMessage = function (req, callback) {\r\n    if (navigator.serviceWorker.controller && navigator.serviceWorker.controller.state == 'activated') {\r\n      console.log('postMessage');\r\n      index++;\r\n      let obj = {\r\n        m: req.m,\r\n        data: req.data\r\n      };\r\n      if (callback) {\r\n        obj.cbid = req.m + '_' + index;\r\n        callbackDict[obj.cbid] = callback;\r\n      }\r\n      navigator.serviceWorker.controller.postMessage(obj); //页面向service worker发送信息\r\n    }\r\n  }\r\n}\r\n\r\n\r\nmodule.exports = postMessage; //postMessage(message, callback)\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/helper/sw_post_message.js","module.exports = {\r\n    supportCache: !!(window.caches && caches.open)\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/helper/ability.js","/**\r\n * 带缓存的ajax请求，约定ret=0为正确数据，可以缓存\r\n * @access public\r\n * @param {String | Object} url 请求地址，url中必须带有t参数作为缓存过期的判断标准。\r\n * @param {Function} [success] 成功回调, 返回值Boolean值，true，把数据存在localStorage中，false,不缓存，\r\n *                         其它值或不返回，根据cache策略缓存\r\n * @param {Function} [error] 不成功回调\r\n * @param {Function} [timeOut] 超时时间\r\n * @param {string} [options.cache=\"\"]     缓存使用方式：\r\n * <p>\"\"             默认不使用缓存；</p>\r\n * <p>\"normal_local\" 表示如果数据有效则直接使用，超过有效期则拉取失败时使用缓存， 缓存在localStorage中；</p>\r\n * <p>\"next_local    表示如果有缓存，则用缓存，但会拉取新数据不render，下次再用， 缓存在localStorage中；</p>\r\n * <p>\"normal_session 表示如果数据有效则直接使用，超过有效期则拉取失败时使用缓存， 缓存在sessionStorage中；</p>\r\n * <p>\"next_session    表示如果有缓存，则用缓存，但会拉取新数据不render，下次再用， 缓存在sessionStorage中；</p>\r\n * @return {Function}  类似Promise的对象\r\n */\r\n\r\n//对于不能缓存的的情况，不要传入cache参数即可\r\nvar _fetch = function(options) {\r\n    var cache = options.cache || \"\";\r\n    var defer = $.Deferred();\r\n\r\n    if(BCD.is.s(options)){\r\n      options = {\r\n        url: options\r\n      };\r\n    }\r\n    BCD.ajaxCache($.extend({\r\n        timeout: 6e3,\r\n        xhrFields: {\r\n            withCredentials: true\r\n        },\r\n        useCache: cache.indexOf('next') === 0,\r\n    }, options, {\r\n        success: function(data){\r\n            try{\r\n                defer.resolve(data);\r\n                var isRight;\r\n                var storage = cache && (cache.indexOf('local') > 0 ? 1 : 2);\r\n                if(options.success){\r\n                    isRight = options.success(data);\r\n                    if(isRight){\r\n                        return storage;\r\n                    }\r\n                }else{\r\n                    isRight = data && data.ret===0;\r\n                }\r\n                return isRight !== false && storage;\r\n            }catch(e){\r\n                console.log(e, 'promise_ajax fetch url \"' + options.url + '\", has wrong in success');\r\n            }\r\n        },\r\n        error: function(){\r\n            try{\r\n                console.log(options.url + ' promise_ajax error');\r\n                defer.resolve(false);\r\n                if(options.errors){\r\n                    options.errors.apply(this, arguments);\r\n                }\r\n            }catch(e){\r\n                console.log(e, 'promise_ajax fetch url \"' + options.url + '\", has wrong in error');\r\n            }\r\n        }\r\n    }));\r\n    return defer.promise();\r\n};\r\n\r\nfunction batchFetch(urls, option){\r\n    var promiseList = (urls || []).map(function(url){\r\n        return _fetch($.extend({\r\n            url: url\r\n        }, option));\r\n    });\r\n    return $.when.apply(promiseList, promiseList).then(function(){\r\n        return arguments;\r\n    });\r\n}\r\n//事件绑定\r\nmodule.exports = {\r\n    fetch: _fetch,\r\n    batchFetch: batchFetch\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/helper/promise_ajax.js","const m_util = require('common/util');\n\nmodule.exports = m_util.load([\n  \"./source/lib/editor.md/editormd.preview.min.css\",\n  \"./source/lib/blog.css\",\n  \"./source/lib/editor.md/lib/marked.min.js\",\n  \"./source/lib/editor.md/lib/prettify.min.js\",\n  \"./source/lib/editor.md/lib/raphael.min.js\",\n  \"./source/lib/editor.md/lib/underscore.min.js\",\n  \"./source/lib/editor.md/lib/sequence-diagram.min.js\",\n  \"./source/lib/editor.md/lib/flowchart.min.js\",\n  \"./source/lib/editor.md/lib/jquery.flowchart.min.js\",\n  \"./source/lib/editor.md/editormd.min.js\"\n]);\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/helper/load_lib.js","const m_util = require('common/util');\nconst m_article = require('model/article');\nconst m_config = require('model/config');\nconst m_commonEvent = require('helper/common_event');\nlet viewHeader = $('<header class=\"navbar navbar-inverse navbar-fixed-top bs-docs-nav\" role=\"banner\"></header>');\n\nfunction hideNavigator(){\n  if(viewHeader.find('.navbar-nav').height() > 66){\n    viewHeader.find('.navbar-toggle').trigger('click');\n  }\n}\nm_commonEvent.onClick('navigator_go', function(ele){\n  hideNavigator();\n  m_commonEvent.go.apply(this, arguments);\n});\nm_commonEvent.onClick('navigator_replaceHash', function(ele){\n  hideNavigator();\n  m_commonEvent.replaceHash.apply(this, arguments);\n});\nBCD.addEvent('navigator_search', function(ele){\n  ele.html('<div class=\"form-group open\">'+\n  '  <input type=\"text\" class=\"form-control\" placeholder=\"Search\">'+\n  '  <ul class=\"dropdown-menu\" style=\"right:auto;display:none\"></ul>'+\n  '</div>'+\n  '<button type=\"submit\" class=\"btn btn-primary\">Submit</button>');\n  let viewInput = ele.find('input');\n  let viewDrop = ele.find('ul').setView({\n    template:'<%(obj||[]).forEach(function(o){%>'+\n    '<li data-on=\"?m=navigator_go\" data-url=\"<%=o.href%>\"><a><%=o.title%></a></li>'+ //\n    '<%})%>'\n  });\n\n  let viewGroup = ele.find('.form-group');\n  const getWord = ()=> viewInput.val().trim();\n  const doSearch = ()=>{\n    let hash = '#!/search/'+encodeURIComponent(getWord());\n    hideNavigator();\n    if(BCD.getHash(0)=='search'){\n      BCD.replaceHash(hash);\n    }else{\n      BCD.go(hash);\n    }\n    setTimeout(function(){\n      viewInput[0].focus(); //延时才能自动focus\n    }, 300);\n  };\n  ele.find('button').on('click', function(e){\n    m_util.stopBubble(e);\n    let word = getWord();\n    if(word){\n      doSearch();\n    }\n  });\n  let selectLi = null;\n  let selectList = null;\n  let index = -1;\n  let oldWord = '';\n  viewInput.on('blur', function(){\n    setTimeout(function(){\n      viewDrop.hide();\n    }, 200);\n  });\n  ele.on('keydown', function(e){//上下选择\n    if(selectList &&(e.keyCode==40 || e.keyCode==38)){\n\n      if(e.keyCode==40){\n        index++;\n        if(index >= selectList.length){\n          index = 0;\n        }\n      }\n      if(e.keyCode==38){\n        index--;\n        if(index <= -selectList.length){\n          index = 0;\n        }\n      }\n      selectList.css('background-color','');\n      selectLi = selectList.eq(index);\n      selectLi.css('background-color','#b2d8fa');\n    }\n  });\n\n  ele.on('keyup', function(e){ //keypress要慢一拍 keypress input keyup\n    let word = getWord();\n    if(word){\n      if(e.keyCode==32){\n        return doSearch();\n      }\n      if(e.keyCode==13){\n        if(selectLi){\n          selectLi.trigger('click');\n        }else{\n          doSearch();\n        }\n      }\n\n      if(word==oldWord){\n        return viewDrop.show();\n      }\n      oldWord = word;\n      let list = m_article.searchDirect(word);\n      if(list.length){\n        index = -1;\n        selectLi = null;\n        viewDrop.reset(list);\n        selectList = viewDrop.find('li');\n      }else{\n        viewDrop.hide();\n      }\n    }else{\n      viewDrop.hide();\n    }\n  });\n})\n\n\n //顶部导航\nmodule.exports = function(option) {\n  option = $.extend({\n    name: 'common/header',\n    getData: function() {\n      return m_config.getConfigSync()\n    },\n    template: '  <div class=\"container\">' +\n      '    <div class=\"navbar-header\">' +\n      '      <button class=\"navbar-toggle\" type=\"button\" data-toggle=\"collapse\" data-target=\".bs-navbar-collapse\">' +\n      '        <span class=\"sr-only\">Toggle navigation</span>' +\n      '        <span class=\"icon-bar\"></span>' +\n      '        <span class=\"icon-bar\"></span>' +\n      '        <span class=\"icon-bar\"></span>' +\n      '      </button>' +\n      '      <a data-on=\"?m=navigator_go\" data-url=\"<%=CONFIG.getIndex()%>\" class=\"logo-link\" style=\"padding: 12px;\"><%-obj.logoTitle%></a>' +\n      '    </div>' +\n      '    <nav class=\"collapse navbar-collapse bs-navbar-collapse\" role=\"navigation\">' +\n      '      <div class=\"navbar-form navbar-right\" data-on=\"?m=navigator_search\"></div>'+\n      '      <ul class=\"nav navbar-nav\"><%(obj.nav || []).forEach(function(o){%>' +\n      '        <li class=\"<%=location.hash==o[1] ? \"active\" : \"\"%>\"><a data-on=\"?m=navigator_replaceHash\" data-url=\"<%=o[1]%>\"><%-o[0]%></a></li>' +\n      '        <%})%>' +\n      '      </ul>' +\n      '    </nav>' +\n      '  </div>'\n  }, option);\n  return viewHeader.setView(option);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/card/common/navigator.js","const c_footer = require('card/common/footer');\nconst c_mainContainer = require('card/common/main_container');\nconst m_article = require('model/article');\nconst m_initOption = require('helper/init_option');\nconst c_pannel = require('card/blog/pannel');\nconst c_pannelList = require('card/blog/pannel_list');\nconst c_articleList = require('card/blog/article_list');\n\n\n\nmodule.exports = function (page, key) {\n  let viewBody = c_mainContainer();\n  let viewTop;\n  let viewList = viewBody.find('[data-selector=\"main\"]');\n  let viewPannelList = c_pannelList(viewBody.find('[data-selector=\"panel\"]'));\n  viewList.setView(c_articleList());\n  viewBody.addView(viewPannelList);\n\n  let viewFoot = c_footer();\n  let currentHash;\n  page.setView({\n    start: function (hasRender) {\n      if (hasRender && currentHash == location.hash && BCD.history.getCode() == -1) {\n        return m_initOption.notRender(hasRender);\n      }\n      currentHash = location.hash;\n      viewList.empty();\n      if (key == 'index') {\n        m_article.getListByTag(0, BCD.getHash(1)).then((data) => {\n          data.title = \"最新未读文章\";\n          data.hrefHead = '#!/index';\n          viewList.reset(data);\n        });\n      } if (key == 'favor') {\n        m_article.getListByFavor(0, BCD.getHash(1)).then((data) => {\n          data.title = \"文章收藏\";\n          data.hrefHead = '#!/favor';\n          console.log(data);\n          viewList.reset(data);\n        });\n      } else if (key == 'tag') {\n        let tag = BCD.getHash(1);\n        m_article.getListByTag(tag, BCD.getHash(2)).then((data) => {\n          data.title = '\"' + tag + '\" 的最新未读文章';\n          data.hrefHead = '#!/tag/' + tag;\n          viewList.reset(data);\n        });\n      } else if (m_article.hasCatalog(key)) {\n        let pageNum = parseInt(BCD.getHash(1) || 0);\n        if (pageNum === 0) {\n          if (viewTop) {\n            viewTop.show();\n          } else {\n            viewTop = c_pannel().reset({\n              isInline: true,\n              list: m_article.getChildCatalog(key).map(o => {\n                return {\n                  href: o.href,\n                  title: o.title\n                }\n              })\n            });\n          }\n          viewList.parent().prepend(viewTop);\n          //console.log('getChildCatalog', key, m_article.getChildCatalog(key));\n        } else if (viewTop) {\n          viewTop.hide();\n        }\n        m_article.getListByCatalog(key, pageNum).then((data) => {\n          data.title = '\"' + data.tag.replace(/^[^/]+\\//, '') + '\" 的最新文章';\n          data.hrefHead = '#!/' + BCD.getHash(0);\n          viewList.reset(data);\n        });\n      }\n    },\n    title: '文章列表',\n    viewList: [viewBody, viewFoot]\n  })\n};\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/page/list.js"," //页脚\r\nconst m_config = require('model/config');\r\nmodule.exports = function(option) {\r\n  let viewHeader = $('<footer></footer>');\r\n  option = $.extend({\r\n    name: 'common/footer',\r\n    getData: function() {\r\n      return m_config.getConfigSync()\r\n    },\r\n    template:\r\n        '<div class=\"container\">'+\r\n        '  <hr>'+\r\n        '  <p class=\"text-center\">Copyright <%-obj.author%> © <%=new Date().getFullYear()%>. All rights reserved.</p>'+\r\n        '</div>'\r\n  }, option);\r\n  return viewHeader.setView(option);\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/card/common/footer.js","module.exports = ()=> $('<div class=\"container\" style=\"min-height:500px\">' +\r\n  '  <div class=\"row\">' +\r\n  '    <div class=\"col-sm-7 col-md-8 col-lg-8\">'+\r\n  '     <div data-selector=\"main\"></div></div>' +\r\n  '    <div class=\"col-sm-5 col-md-4 col-lg-4\" data-selector=\"panel\"></div>' +\r\n  '  </div>' +\r\n  '</div>');\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/card/common/main_container.js","function anchorBack() {\r\n    if (history.state && history.state.scrollY) { //支持锚点返回\r\n        if (BCD.history.getCode() == -1) {\r\n            scrollTo(0, history.state.scrollY);\r\n        }\r\n        BCD.extendState({ //保证刷新可回到头部\r\n            scrollY: 0\r\n        });\r\n    }\r\n}\r\n\r\n//带锚点返回，不reset子view\r\nfunction notRender(hasRender) {\r\n    if (hasRender) {\r\n        BCD.getPage().show();\r\n        anchorBack();\r\n        return 'show';\r\n    }\r\n}\r\nmodule.exports = {\r\n    notRender,\r\n    anchorBack\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/helper/init_option.js"," //顶部导航\r\nmodule.exports = function(option) {\r\n  let view = $('<div class=\"panel panel-primary\"></div>');\r\n  option = $.extend({\r\n    name: 'blog/panel',\r\n    template:\r\n      '<%if(obj.title){%><div class=\"panel-heading\">' +\r\n      '  <h4><%-obj.title%></h4>' +\r\n      '</div><%}%>' +\r\n      '<div class=\"panel-body\">' +\r\n      '  <%if(obj.isInline){%>' +\r\n      '    <ul class=\"list-inline\">'+\r\n      '     <%(obj.list || []).forEach(function(o){%>' +\r\n      '      <%if(o.href){%>'+\r\n      '       <li><a data-on=\"?m=go\" data-url=\"<%=o.href%>\"><%=o.title%></a></li>'+\r\n      '      <%}else{%>'+\r\n      '       <li><a data-on=\"?m=go\" data-url=\"#!/tag/<%=o%>\"><%=o%></a></li>'+\r\n      '      <%}%>' +\r\n      '     <%})%>'+\r\n      '    </ul>' +\r\n      '  <%}else{%>' +\r\n      '    <ul class=\"list-group\">' +\r\n      '     <%(obj.list || []).forEach(function(o){%>' +\r\n      '      <li class=\"list-group-item\"><a data-on=\"?m=go\" data-url=\"<%=o.href%>\"><%=o.title%></a>'+\r\n      '       <%=o.time ? \"<span style=\\\\\\\"color: #a2a34f;\\\\\\\">(\"+o.time+\")</span>\" : \"\"%></li>' +\r\n      '     <%})%>'+\r\n      '    </ul>' +\r\n      '    <%}%>' +\r\n      '</div>',\r\n    end: function(data){\r\n      if(!(data && data.list && data.list.length)){\r\n        this.hide();\r\n        return 'hide';\r\n      }\r\n    }\r\n  }, option);\r\n  return view.setView(option);\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/card/blog/pannel.js","const m_article = require('model/article');\r\nconst m_recommend = require('helper/recommend');\r\nconst c_pannel = require('card/blog/pannel');\r\nconst m_util = require('common/util');\r\nmodule.exports = (view) => {\r\n  let viewPannelBook = c_pannel({\r\n    data: {\r\n      title: '书籍',\r\n      list: m_article.getBooks().map(o => {\r\n        return {\r\n          href: o.href,\r\n          title: o.title,\r\n          time: o.time\r\n        }\r\n      })\r\n    }\r\n  });\r\n  let viewPannelCatalog = c_pannel({\r\n    data: {\r\n      title: '分类',\r\n      list: m_article.getCatalogs().filter(o => o.tagList.length === 1).map(o => {\r\n        return {\r\n          title: o.title,\r\n          href: o.href\r\n        }\r\n      })\r\n    }\r\n  });\r\n  let viewPannelTag = c_pannel({\r\n    data: {\r\n      isInline: true,\r\n      title: '标签',\r\n      list: m_article.getTags()\r\n    }\r\n  });\r\n\r\n  let viewPannelRecommendPost = c_pannel({\r\n    delay: true\r\n  });\r\n  m_recommend.getRecommend(function(list){\r\n    viewPannelRecommendPost.reset({\r\n      title: '推荐阅读',\r\n      list: list.map(o => {\r\n        return {\r\n          href: o.href,\r\n          title: o.title,\r\n          time: o.time\r\n        }\r\n      })\r\n    });\r\n  });\r\n\r\n  if(m_util.dom.getWindowWidth() < 766){\r\n      return view.setView({\r\n        source: function(){\r\n            return new Promise(function(resolve){\r\n                setTimeout(resolve, 1E3);\r\n            });\r\n        },\r\n        viewList: [viewPannelRecommendPost, viewPannelBook, viewPannelCatalog, viewPannelTag]\r\n      });\r\n  }\r\n  return view.setView({\r\n    viewList: [viewPannelBook, viewPannelCatalog, viewPannelTag, viewPannelRecommendPost]\r\n  });\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/card/blog/pannel_list.js","const m_util = require('common/util');\r\nconst m_article = require('model/article');\r\nconst m_search = require('helper/search');\r\nconst m_readHistory = require('model/read_history');\r\n\r\nconst filter = (list) => {\r\n  let arr = [];\r\n  let itemSet = new Set(list);\r\n  let uniqList = [...itemSet];\r\n  let currentPath = decodeURIComponent(location.hash.replace('#!/', ''));\r\n  uniqList.some(function (o) {\r\n    if (!m_readHistory.hasRead(o.path) && o.path != currentPath) {\r\n      arr.push(o);\r\n      if (arr.length > 10) {\r\n        return true;\r\n      }\r\n    }\r\n  });\r\n  return arr;\r\n};\r\n\r\nconst getCorrelation = (a_tfList) => {\r\n  let tfDict = {};\r\n  a_tfList.forEach(o => {\r\n    tfDict[o.token] = o.frequency;\r\n  });\r\n  return (b_tfList) => {\r\n    let total = b_tfList.reduce((sum, item) => sum += item.frequency, 0);\r\n    return b_tfList.reduce((weight, item) => {\r\n      if((typeof tfDict[item.token] == 'number') && (typeof item.frequency == 'number')) {\r\n         weight += (tfDict[item.token] || 0) * item.frequency / total;\r\n      }\r\n      return weight;\r\n    }, 0);\r\n  };\r\n};\r\n\r\nconst getSimilarArticles = (a_tfList) => {\r\n  let list = m_article.getArticleList().filter(o => o.tfList && o.tfList.length);\r\n  let calModel = getCorrelation(a_tfList);\r\n  let weightList = list.map(o => {\r\n    return {\r\n      article: o,\r\n      weight: calModel(o.tfList)\r\n    }\r\n  }).sort((a, b) => b.weight - a.weight);\r\n  console.table(weightList.slice(0, 20).map(o => {\r\n    return {\r\n      title: o.article.title,\r\n      weight: o.weight\r\n    }\r\n  }));\r\n  return weightList.map(o => o.article);\r\n}\r\n\r\nconst getMutiSamples = () => {\r\n  let tagDict = {};\r\n  let retList = [];\r\n  let originList = m_article.getArticleList();\r\n  let list = originList.filter(o => !m_readHistory.hasRead(o.path));\r\n  if (list.some(o => {\r\n      let tagList = o.tagList || [];\r\n      let tagName = tagList[tagList.length - 1];\r\n      if (tagDict[tagName]) {\r\n        tagDict[tagName].push(o);\r\n      } else {\r\n        tagDict[tagName] = [];\r\n        retList.push(o);\r\n      }\r\n      if (retList.length == 10) {\r\n        return true;\r\n      }\r\n    })) {\r\n    return retList;\r\n  } else {\r\n    let tagList = Object.keys(tagDict);\r\n    for (var i = 0; i < 10; i++) {\r\n      for (var j = 0; j < tagList.length; j++) {\r\n        let item;\r\n        let tagName = tagList[j];\r\n        if (item = tagDict[tagName][i]) {\r\n          retList.push(item);\r\n          if (retList.length == 10) {\r\n            return retList;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return retList.concat(originList.slice(0, 10 - retList.length));\r\n}\r\n\r\n\r\n\r\nconst getRecommend = (callback) => {\r\n  let delayTime = 2E3 - (m_util.now() - m_article.startTime);\r\n  delayTime = m_article.isPreload ? 0 : (delayTime < 0 ? 0 : delayTime);\r\n  setTimeout(function () {\r\n    let key = decodeURIComponent(BCD.getHash(0));\r\n\r\n    switch (true) {\r\n    case key == 'tag':\r\n      let word = decodeURIComponent(BCD.getHash(1));\r\n      m_article.searchList(word, (list) => {\r\n        callback(filter(list.concat(getMutiSamples())));\r\n      }, true);\r\n      break;\r\n    case m_article.hasArticle(key):\r\n      m_article.getArticleContent(key).then((data) => {\r\n        let tagList = data.tagList;\r\n        let keyWords = (data.tfList || []).slice(0, 10).map(o => o.token + '(' + o.frequency + ')');\r\n        console.log('本文关键词为：', keyWords.join(','));\r\n        callback(filter(getSimilarArticles(data.tfList).concat(getMutiSamples())));\r\n      });\r\n      break;\r\n    case m_article.hasCatalog(key):\r\n      m_article.getListByCatalog(key, 0, 999).then((data) => {\r\n        //在目录列表中已经有当前目录文章的展示了，在这里优先展示搜索到的内容\r\n        let catalog = m_article.getCatalogMessage(key);\r\n        let alist = data.list || [];\r\n        m_article.searchList(catalog.tagList.join(' '), (list) => {\r\n          callback(filter(list.concat(alist.concat(getMutiSamples()))));\r\n        }, true);\r\n      });\r\n      break;\r\n\r\n    default:\r\n      callback(getMutiSamples());\r\n      break;\r\n    }\r\n  }, delayTime);\r\n\r\n};\r\nmodule.exports = {\r\n  getRecommend\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/helper/recommend.js"," //文章列表\nmodule.exports = function(option) {\n  return $.extend({\n    name: 'blog/article_list',\n    template: '<h3><%=obj.title%></h3>' +\n      '<%if(!(obj.list && obj.list.length)){%>'+\n      '<br><hr><center><h3>暂无内容</h3></center>'+\n      '<%}else{(obj.list || []).forEach(function(o, idx){%><article>' +\n      '  <h2><a data-on=\"?m=go\" data-url=\"<%=o.href%>\"><%-o.title%></a></h2>' +\n      '  <div class=\"row\">' +\n      '    <div class=\"group1 col-sm-6 col-md-6\">' +\n      '      <span class=\"glyphicon glyphicon-folder-open\"></span><%(o.tagList||[]).forEach(function(item, i, arr){%>'+\n      '       <%=i ? \"&nbsp;>&nbsp;\" : \"&nbsp;\"%><a data-on=\"?m=go\" '+\n      '       data-url=\"#!/<%=encodeURIComponent([\"blog\"].concat(arr.slice(0, i+1)).join(\"/\"))%>\"><%=item%></a><%})%>' +\n      '    </div>' +\n      '    <div class=\"group2 col-sm-6 col-md-6\">' +\n      '      <span data-on=\"?m=article_down\" data-url=\"<%=o.path%>\"><span class=\"glyphicon glyphicon-download\"></span>&nbsp;踩&nbsp;&nbsp;</span>' +\n      '      <span data-on=\"?m=favor&idx=<%=idx%>\" style=\"color: darkmagenta;\" class=\"glyphicon glyphicon-star-empty\"></span>&nbsp;收藏&nbsp;&nbsp;' +\n      '      <span class=\"glyphicon glyphicon-time\"></span>&nbsp;<%-o.time%>' +\n      '    </div>' +\n      '  </div>' +\n      '  <hr>' +\n      '  <div data-on=\"?m=mkview&idx=<%=idx%>\">'+\n      '  </div><br />' +\n      '' +\n      '  <p class=\"text-right\">' +\n      '    <a data-on=\"?m=go\" data-url=\"<%=o.href%>\">' +\n      '      continue reading...' +\n      '    </a>' +\n      '  </p>' +\n      '  <hr>' +\n      '</article><%})%>' +\n      '' +\n      '<ul class=\"pager\">' +\n      '  <li class=\"previous\"><a <%if(obj.page==0){%>style=\"opacity: 0.5;\"<%}else{%>'+\n      'data-on=\"?m=go\" data-url=\"<%=obj.hrefHead+\"/\"+(obj.page-1)%>\"<%}%>>&larr; Previous</a></li>' +\n      '  <li class=\"next\"><a <%if(obj.page==Math.floor(obj.num/obj.count)){%>style=\"opacity: 0.5;\"<%}else{%>'+\n      'data-on=\"?m=go\" data-url=\"<%=obj.hrefHead+\"/\"+(obj.page+1)%>\"<%}%>>Next &rarr;</a></li>' +\n      '</ul><%}%>'\n  }, option);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/card/blog/article_list.js","const s_mainContainer = require('card/common/slidebar_container');\r\nconst m_article = require('model/article');\r\nconst m_readHistory = require('model/read_history');\r\nconst c_articleList = require('card/blog/article_list');\r\n\r\n\r\n\r\nmodule.exports = function (page, key) {\r\n  page.html(s_mainContainer);\r\n  let viewContent = page.find('[data-selector=\"main\"]');\r\n  let viewSlidebar = page.find('[data-selector=\"slidebar\"]');\r\n  let slidebar;\r\n  let currentHash;\r\n  viewSlidebar.setView({\r\n    name: 'blog/slidebar',\r\n    template: '<div data-on=\"?m=mkview\"></div>'\r\n  });\r\n\r\n  viewContent.setView({\r\n    name: 'blog/blog',\r\n    template: '<div data-on=\"?m=mkview\"></div>'\r\n  });\r\n\r\n\r\n  page.setView({\r\n    title: m_article.getName(key),\r\n    start: function () {\r\n      if (currentHash !== location.hash) {\r\n        viewContent.empty();\r\n        currentHash = location.hash;\r\n      }\r\n      this.show();\r\n      m_article.getArticleContent(m_article.getSidebarPath(key)).then((data) => {\r\n        let baseHash = '#!/' + BCD.getHash(0);\r\n        if (!slidebar) {\r\n          slidebar = $.extend({}, data);\r\n          let content = slidebar.content || '';\r\n          let chapters = slidebar.chapters = [];\r\n\r\n          slidebar.content = content.replace(/<%(([^>]|[^%]>)+)%>/g, function ($0, $1) {\r\n            let item = {};\r\n            let fileName = '';\r\n            if ($1.indexOf(']')>0) { //这种格式：[描述](相对与当前目录的地址)\r\n              let arr = $1.substr(1, $1.length - 2).split(/\\]\\s*\\(/);\r\n              item.title = arr[0] || '';\r\n              item.href  = baseHash + '/' + (arr[1] || '');\r\n              fileName = arr[1];\r\n            } else {\r\n              item.title = $1;\r\n              item.href = baseHash + '/' + $1 + '.md';\r\n              fileName = $1 + '.md';\r\n            }\r\n            item.path = key+'/'+fileName;\r\n            if(m_article.hasArticle(item.path)){\r\n              chapters.push(item);\r\n            }\r\n            return '<a data-on=\"?m=replaceHash\" data-url=\"' + item.href + '\">' + item.title + '</a>'+\r\n            '<span data-path=\"'+item.path+'\" class=\"icon glyphicon glyphicon-ok\" aria-hidden=\"true\" '+\r\n            'style=\"'+(m_readHistory.hasRead(item.path) ? '' : 'display:none')+'\"></span>';\r\n          });\r\n          viewSlidebar.reset(slidebar);\r\n          setTimeout(function () {\r\n            viewSlidebar.bindEvent();\r\n          });\r\n        }\r\n        let fileName = key + location.hash.replace(baseHash, '');\r\n        if (m_article.hasArticle(fileName)) {\r\n          m_article.getArticleContent(fileName).then((data) => {\r\n            m_readHistory.addHistory(fileName);\r\n            $(viewSlidebar.find('.active')).removeClass('active');\r\n            let currentDom = $('.slidebar [data-path=\"'+fileName+'\"]');\r\n            currentDom.parent().addClass('active');\r\n            currentDom.show();\r\n            viewContent.reset(data);\r\n          });\r\n        } else if (slidebar.chapters[0]) {\r\n          return BCD.replaceHash(slidebar.chapters[0].href);\r\n        } else {\r\n          viewContent.reset({\r\n            content: '敬请期待',\r\n            title: fileName\r\n          });\r\n        }\r\n      });\r\n    }\r\n  })\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/page/book.js","module.exports = \r\n  '  <div class=\"row\">' +\r\n  '    <div class=\"slidebar col-sm-5 col-md-4 col-lg-3\" data-selector=\"slidebar\"></div>' +\r\n  '    <div class=\"col-sm-offset-5 col-md-offset-4 col-lg-offset-3 col-sm-7 col-md-8 col-lg-9\" data-selector=\"main\"></div>' +\r\n  '  </div>';\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/card/common/slidebar_container.js","//有侧边栏的内容展示\r\n\r\nconst c_mainContainer = require('card/common/main_container');\r\nconst c_footer = require('card/common/footer');\r\nconst m_article = require('model/article');\r\nconst m_readHistory = require('model/read_history');\r\nconst c_pannelList = require('card/blog/pannel_list');\r\nconst c_content = require('card/blog/content');\r\nconst m_initOption = require('helper/init_option');\r\n\r\n\r\n\r\nmodule.exports = function(page, key) {\r\n  let viewBody = c_mainContainer();\r\n  let viewContent = viewBody.find('[data-selector=\"main\"]');\r\n  let viewPannelList = c_pannelList(viewBody.find('[data-selector=\"panel\"]'));\r\n  viewContent.setView(c_content({\r\n    delay: true\r\n  }));\r\n  viewBody.addView(viewContent);\r\n  viewBody.addView(viewPannelList);\r\n\r\n  let viewFoot = c_footer();\r\n  page.setView({\r\n    start: function(hasRender){\r\n      if(hasRender){\r\n        return m_initOption.notRender(hasRender);\r\n      }\r\n      if(m_article.hasArticle(key)){\r\n        m_article.getArticleContent(key).then((data)=>{\r\n          m_readHistory.addHistory(key);\r\n          page.setView({title: data.title});\r\n          document.title = data.title;\r\n          viewContent.reset(data);\r\n        });\r\n      }\r\n    },\r\n    viewList: [viewBody, viewFoot]\r\n  })\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/page/content.js","window.CONFIG = require('model/config');\n\n\n//单个文章\nmodule.exports = function (option) {\n  return $.extend({\n    name: 'blog/content',\n    template:\n      '<h1><%=obj.title%></h1>' +\n      '  <div class=\"row\">' +\n      '    <div class=\"group1 col-sm-6 col-md-6\">' +\n      '      <span class=\"glyphicon glyphicon-folder-open\"></span><%(obj.tagList||[]).forEach(function(item, i, arr){%>'+\n      '       <%=i ? \"&nbsp;>&nbsp;\" : \"&nbsp;\"%><a data-on=\"?m=go\" '+\n      '       data-url=\"#!/<%=encodeURIComponent([\"blog\"].concat(arr.slice(0, i+1)).join(\"/\"))%>\"><%=item%></a><%})%>' +\n      '    </div>' +\n      '    <div class=\"group2 col-sm-6 col-md-6\">' +\n      '      <span data-on=\"?m=favor\" style=\"color: darkmagenta;\" class=\"glyphicon glyphicon-star-empty\"></span>&nbsp;收藏&nbsp;&nbsp;' +\n      '      <span class=\"glyphicon glyphicon-time\"></span>&nbsp;<%-obj.time%>' +\n      '    </div>' +\n      '  </div>' +\n      '  <hr>' +\n      '  <div data-on=\"?m=mkview\">' +\n      '  </div><br />' +\n      '  <hr>' +\n      '</article>' +\n      '<ul class=\"pager\">' +\n      '  <li class=\"previous\"><a data-on=\"?m=back\">← 返回</a></li>' +\n      ' <li><a target=\"_blank\" rel=\"noopener\" href=\"<%=CONFIG.getSearchIssueURL(obj.title)%>\">查看评论</a></li>' +\n      ' <li class=\"next\"><a target=\"_blank\" rel=\"noopener\" href=\"<%=CONFIG.getNewIssueURL(obj.title)%>\">去评论 &rarr;</a></li>' +\n      '</ul>'\n  }, option);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/card/blog/content.js","//针对导航的，没有侧边栏的内容展示\r\n\r\nconst c_mainContainer = require('card/common/main_container');\r\nconst c_footer = require('card/common/footer');\r\nconst m_config = require('model/config');\r\nconst m_article = require('model/article');\r\nconst m_initOption = require('helper/init_option');\r\n\r\n\r\n\r\nmodule.exports = function(page) {\r\n  let viewBody = $('<div class=\"container\" style=\"min-height:'+((window.innerHeight||640) -200)+'px\"/>').setView({\r\n   name: 'blog/blog',\r\n   delay: true,\r\n   template: '<div data-on=\"?m=mkview\"></div>'\r\n });\r\n\r\n  let viewFoot = c_footer();\r\n  page.setView({\r\n    start: function(hasRender){\r\n      if(hasRender && BCD.history.getCode()==-1){\r\n        return m_initOption.notRender(hasRender);\r\n      }\r\n      let key = location.hash.replace('#!/', '');\r\n      if(m_article.hasArticle(key)){\r\n        m_article.getArticleContent(key).then((data)=>{\r\n          page.setView({title: data.title});\r\n          document.title = data.title;\r\n          viewBody.reset(data);\r\n        });\r\n      }else{\r\n        BCD.replaceHash(m_config.getIndex());\r\n      }\r\n    },\r\n    viewList: [viewBody, viewFoot]\r\n  })\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/page/blog.js","const c_footer = require('card/common/footer');\r\nconst c_mainContainer = require('card/common/main_container');\r\nconst m_initOption = require('helper/init_option');\r\nconst c_pannelList = require('card/blog/pannel_list');\r\nconst m_pullArticle = require('card/blog/pull_article');\r\n\r\nmodule.exports = function (page, key) {\r\n  let viewBody = c_mainContainer();\r\n  let viewList = viewBody.find('[data-selector=\"main\"]');\r\n  let viewPannelList = c_pannelList(viewBody.find('[data-selector=\"panel\"]'));\r\n  viewList.setView({\r\n    viewList: [m_pullArticle.container]\r\n  });\r\n\r\n  viewBody.addView(viewList);\r\n  viewBody.addView(viewPannelList);\r\n\r\n  let viewFoot = c_footer();\r\n  let oldWord = '';\r\n  page.setView({\r\n    start: function (hasRender) {\r\n      let word = decodeURIComponent(BCD.getHash(1));\r\n      if (hasRender && oldWord == word) {\r\n        return m_initOption.notRender(true);\r\n      }\r\n      oldWord = word;\r\n      m_pullArticle.init(word);\r\n    },\r\n    title: '搜索结果',\r\n    viewList: [viewBody, viewFoot]\r\n  })\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/page/search.js","/**\r\n * 不断增加的列表\r\n */\r\nconst m_article = require('model/article');\r\nvar container = $('<div style=\"min-height:none;\">' +\r\n  '<div data-selector=\"tips\" style=\"margin: 20px;font-size: 20px;\"></div>' +\r\n  '<div data-selector=\"pull_list\"></div>' +\r\n  '</div>');\r\n\r\nvar viewRank = $(container.find('[data-selector=\"pull_list\"]'));\r\nvar viewTips = $(container.find('[data-selector=\"tips\"]'));\r\n\r\nviewRank.setView({\r\n  full: 'append',\r\n  template: '<%(obj.list || []).forEach(function(o, idx, list){%><article>' +\r\n    '  <h2><a data-on=\"?m=go\" data-url=\"<%=o.href%>\"><%=o.title%></a></h2>' +\r\n    '  <div class=\"row\">' +\r\n    '    <div class=\"group1 col-sm-6 col-md-6\">' +\r\n    '      <span class=\"glyphicon glyphicon-folder-open\"></span><%(o.tagList||[]).forEach(function(item, i, arr){%>' +\r\n    '       <%=i ? \"&nbsp;>&nbsp;\" : \"&nbsp;\"%><a data-on=\"?m=go\" ' +\r\n    '       data-url=\"#!/<%=encodeURIComponent([\"blog\"].concat(arr.slice(0, i+1)).join(\"/\"))%>\"><%=item%></a><%})%>' +\r\n    '    </div>' +\r\n    '    <div class=\"group2 col-sm-6 col-md-6\">' +\r\n    '      <span class=\"glyphicon glyphicon-time\"></span>&nbsp;<%-o.time%>' +\r\n    '    </div>' +\r\n    '  </div>' +\r\n    '  <hr>' +\r\n    '  <div data-on=\"?m=mkview&idx=<%=idx%>\">' +\r\n    '  </div><br />' +\r\n    '  <p class=\"text-right\">' +\r\n    '    <a data-on=\"?m=go\" data-url=\"<%=o.href%>\">' +\r\n    '      continue reading...' +\r\n    '    </a>' +\r\n    '  </p>' +\r\n    '  <%if(idx<list.length-1)print(\"<hr>\")%>' +\r\n    '</article><%})%>'\r\n});\r\n\r\n\r\nmodule.exports = {\r\n  container,\r\n  init: (word) => {\r\n    let count = 0;\r\n    let processCount = 0;\r\n    let keyWord = '<span class=\"text-danger\">' + word + '</span>'\r\n    viewTips.html('正在搜索：' + keyWord);\r\n    viewRank.empty();\r\n    m_article.searchList(word, function (data) {\r\n      viewRank.reset(data);\r\n      count += data.list && data.list.length || 0;\r\n      processCount += data.checkNum;\r\n      if (processCount < data.totalNum) {\r\n        viewTips.html('在(' + processCount + '/' + data.totalNum + ')搜索到' +\r\n          count + '篇关于：' + keyWord);\r\n      } else {\r\n        viewTips.html('在' + data.totalNum + '篇文章中搜索到' +\r\n          count + '篇关于：' + keyWord);\r\n      }\r\n\r\n      //console.log(data);\r\n    });\r\n  }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/card/blog/pull_article.js","require('helper/notification.js');\r\nrequire('helper/auto_cache.js');\r\n\r\n\r\nmodule.exports = function (page) {\r\n  page.addClass('text-center').html('<p style=\"margin-top: 200px;with:600px\"><label>' +\r\n    (window.Notification ? '您已禁止了通知，请重新设置' : '您的浏览器不支持该特性，请使用最新的Chrome浏览器') + '</label>' +\r\n    '<button style=\"margin-left: 20px;min-width: 150px;\"' +\r\n    ' data-on=\"?m=subscribePush\"' +\r\n    ' class=\"btn btn-warning btn-sm\">订阅</button></p>' +\r\n    '<p style=\"margin-top: 50px;with:600px\"><label></label><button style=\"margin-left: 20px;min-width: 150px;\"' +\r\n    ' data-on=\"?m=autoCache\"' +\r\n    ' class=\"btn btn-warning btn-sm\">自动缓存全站</button></p>'\r\n  );\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/page/setting.js","var isSubscribed = false;\n\nBCD.addEvent('subscribePush', function (fabPushElement) {\n  //Push notification button\n  var tipsElement = fabPushElement.prev();\n  //To check `push notification` is supported or not\n  var isPushSupported = function () {\n    console.log('check support');\n    //To check `push notification` permission is denied by user\n    if (!window.Notification || Notification.permission === 'denied') {\n      console.log('User has blocked push notification.');\n      return;\n    }\n\n    //Check `push notification` is supported or not\n    if (!('PushManager' in window)) {\n      console.log('Sorry, Push notification isn\\'t supported in your browser.');\n      return;\n    }\n    //Click event for subscribe push\n    fabPushElement.on('click', function () {\n      if (isSubscribed) {\n        unsubscribePush();\n      } else {\n        subscribePush();\n      }\n    });\n    //Get `push notification` subscription\n    //If `serviceWorker` is registered and ready\n    navigator.serviceWorker.ready\n      .then(function (registration) {\n        registration.pushManager.getSubscription()\n          .then(function (subscription) {\n            //If already access granted, enable push button status\n            //Tell application server to delete subscription\n            if (subscription) {\n              changePushStatus(true);\n            } else {\n              changePushStatus(false);\n            }\n          })\n          .catch(function (error) {\n            console.error('Error occurred while enabling push ', error);\n          });\n      });\n  }\n\n  // Ask User if he/she wants to subscribe to push notifications and then\n  // ..subscribe and send push notification\n  function subscribePush() {\n    navigator.serviceWorker.ready.then(function (registration) {\n      if (!registration.pushManager) {\n        console.log('Your browser doesn\\'t support push notification.');\n        return false;\n      }\n\n      //To subscribe `push notification` from push manager\n      registration.pushManager.subscribe({\n          userVisibleOnly: true //Always show notification when received\n        })\n        .then(function (subscription) {\n          console.info('Push notification subscribed.');\n          console.log(subscription);\n          saveSubscriptionID(subscription);\n          changePushStatus(true);\n        })\n        .catch(function (error) {\n          changePushStatus(false);\n          console.error('Push notification subscription error: ', error);\n        });\n    })\n  }\n\n  // Unsubscribe the user from push notifications\n  function unsubscribePush() {\n    navigator.serviceWorker.ready\n      .then(function (registration) {\n        //Get `push subscription`\n        registration.pushManager.getSubscription()\n          .then(function (subscription) {\n            //If no `push subscription`, then return\n            if (!subscription) {\n              console.log('Unable to unregister push notification.');\n              return;\n            }\n\n            //Unsubscribe `push notification`\n            subscription.unsubscribe()\n              .then(function () {\n                console.info('Push notification unsubscribed.');\n                console.log(subscription);\n                deleteSubscriptionID(subscription);\n                changePushStatus(false);\n              })\n              .catch(function (error) {\n                console.error(error);\n              });\n          })\n          .catch(function (error) {\n            console.error('Failed to unsubscribe push notification.');\n          });\n      })\n  }\n\n  //To change status\n  function changePushStatus(status) {\n    isSubscribed = status;\n    if (status) {\n      tipsElement.html('您已订阅，取消订阅后您将收不到更新提示！');\n      fabPushElement.removeClass('btn-success').addClass('btn-warning').html('取消订阅');\n    } else {\n      tipsElement.html('您未订阅，订阅后您将可以收到更新提示');\n      fabPushElement.removeClass('btn-warning').addClass('btn-success').html('订阅');\n    }\n  }\n\n\n  function saveSubscriptionID(subscription) {\n    var subscription_id = subscription.endpoint.split('gcm/send/')[1];\n\n    console.log(\"Subscription ID\", subscription_id);\n    new Image().src = 'http://119.29.150.243:3333/api/subscript/' + subscription_id;\n\n    // fetch((location.protocol=='http:' ? 'http://119.29.150.243:3333/api/users'\n    // : 'https://119.29.150.243:3011/api/users'), {\n    //   method: 'post',\n    //   headers: {\n    //     'Accept': 'application/json',\n    //     'Content-Type': 'application/json'\n    //   },\n    //   body: JSON.stringify({\n    //     user_id: subscription_id\n    //   })\n    // });\n  }\n\n  function deleteSubscriptionID(subscription) {\n    var subscription_id = subscription.endpoint.split('gcm/send/')[1];\n\n    new Image().src = 'http://119.29.150.243:3333/api/unsubscript/' + subscription_id;\n    // fetch((location.protocol=='http:' ? 'http://119.29.150.243:3333/api/user/'\n    // : 'https://119.29.150.243:3011/api/user/') + subscription_id, {\n    //   method: 'get',\n    //   headers: {\n    //     'Accept': 'application/json',\n    //     'Content-Type': 'application/json'\n    //   }\n    // });\n  }\n\n  isPushSupported(); //Check for push notification support\n});\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/helper/notification.js","//这是个单例\r\n\r\nconst m_article = require('model/article');\r\nvar m_setting = BCD.cache.getLocal('swblog_setting', {autoCache: false});\r\nvar btnElement, tipsElement, timer;\r\n\r\nm_article.onUpdate(function(){\r\n    if(tipsElement){\r\n        m_article.initArticle.then(function(articleList){\r\n            var noContents = articleList.filter(function(o){\r\n                return !o.content;\r\n            });\r\n            tipsElement.html('已缓存文章：'+(articleList.length - noContents.length)+'篇');\r\n        });\r\n    }\r\n});\r\n\r\n//To change status\r\nfunction changeStatus(status) {\r\n  m_setting.autoCache = status;\r\n  BCD.cache.setLocal('swblog_setting', m_setting, {permanent: true});\r\n  clearTimeout(timer);\r\n  timer = setTimeout(function(){\r\n      m_article.initArticle.then(function(articleList){\r\n          var noContents = articleList.filter(function(o){\r\n              return !o.content;\r\n          });\r\n          tipsElement.html('已缓存文章：'+(articleList.length - noContents.length)+'篇');\r\n          if(m_setting.autoCache){\r\n              m_article.autoLoad();\r\n          }\r\n      });\r\n  }, 5E3);\r\n\r\n  if (status) {\r\n    btnElement.removeClass('btn-success').addClass('btn-warning').html('按需缓存');\r\n  } else {\r\n    btnElement.removeClass('btn-warning').addClass('btn-success').html('自动缓存全站');\r\n  }\r\n}\r\n\r\n\r\nBCD.addEvent('autoCache', function (ele) {\r\n    btnElement = ele;\r\n    tipsElement = ele.prev();\r\n    changeStatus(m_setting.autoCache);\r\n    btnElement.on('click', function(){\r\n        changeStatus(!m_setting.autoCache);\r\n    });\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/helper/auto_cache.js"],"sourceRoot":""}